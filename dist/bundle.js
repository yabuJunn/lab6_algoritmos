(()=>{"use strict";var e;!function(e){e.ADD_EPISODES="ADD_EPISODES",e.ADD_CHARACTER="ADD_CHARACTER"}(e||(e={}));const t=[];let n={episodes:[],characters:[]};const o=o=>{const i=JSON.parse(JSON.stringify(n));n=((t,n)=>{switch(t.type){case e.ADD_EPISODES:return Object.assign(Object.assign({},n),{episodes:JSON.parse(t.payload)});case e.ADD_CHARACTER:return Object.assign(Object.assign({},n),{characters:JSON.parse(t.payload)});default:return n}})(o,i),t.forEach((e=>e.render())),console.log(n)};const i=e=>{return t=void 0,n=void 0,i=function*(){const t=yield fetch(e),n=yield t.json();return n.hasOwnProperty("results")?n.results:n},new((o=void 0)||(o=Promise))((function(e,s){function r(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o((function(e){e(n)}))).then(r,a)}c((i=i.apply(t,n||[])).next())}));var t,n,o,i};var s=function(e,t,n,o){return new(n||(n=Promise))((function(i,s){function r(e){try{c(o.next(e))}catch(e){s(e)}}function a(e){try{c(o.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,a)}c((o=o.apply(e,t||[])).next())}))};const r=e=>{const t=[];return e.forEach((e=>s(void 0,void 0,void 0,(function*(){e.characters.forEach((e=>s(void 0,void 0,void 0,(function*(){t.includes(e)||t.push(e)}))))})))),t},a=e=>s(void 0,void 0,void 0,(function*(){const t=[];return e.forEach((e=>s(void 0,void 0,void 0,(function*(){t.push(yield i(e))})))),t}));class c extends HTMLElement{static get observedAttributes(){return Object.keys({name:null,air_date:null,characters:null,episode:null})}constructor(){super(),this.properties={name:"",air_date:"",characters:"",episode:""},this.attachShadow({mode:"open"})}attributeChangedCallback(e,t,n){switch(e){case"name":this.properties.name=n;break;case"air_date":this.properties.air_date=n;break;case"characters":this.properties.characters=n;break;case"episode":this.properties.episode=n}}connectedCallback(){this.render()}render(){var e,t;const o=this.ownerDocument.createElement("link");o.setAttribute("rel","stylesheet"),o.setAttribute("href","/src/components/episodeCard/episodeCard.css"),null===(e=this.shadowRoot)||void 0===e||e.appendChild(o);const i=this.ownerDocument.createElement("div");i.setAttribute("class","episodeCard"),null===(t=this.shadowRoot)||void 0===t||t.appendChild(i);const s=this.ownerDocument.createElement("h1");s.textContent=this.properties.name,i.appendChild(s);const r=this.ownerDocument.createElement("h2");r.textContent=`Serial: ${this.properties.episode}`,i.appendChild(r);const a=this.ownerDocument.createElement("p");a.textContent=`This episode was aired on ${this.properties.air_date}`,i.appendChild(a);const c=this.ownerDocument.createElement("p");c.textContent="These characters appeared in this episode:",i.appendChild(c);const d=this.ownerDocument.createElement("ul");JSON.parse(this.properties.characters).forEach((e=>{var t;null===(t=n.characters)||void 0===t||t.forEach((t=>{if(t.id===(e=>{let t=e.match(/(\d+)/);if(t)return parseInt(t[0])})(e)){const e=this.ownerDocument.createElement("li");d.appendChild(e);const n=this.ownerDocument.createElement("p");n.textContent=t.name,e.appendChild(n),n.addEventListener("click",(()=>{if(console.log(),null===e.querySelector("img")){const n=this.ownerDocument.createElement("img");n.setAttribute("src",t.image),e.appendChild(n),console.log("No hay imagen")}else{const t=e.querySelector("img");e.removeChild(t),console.log("Si imagen")}}))}}))})),i.appendChild(d)}}customElements.define("episode-card",c);s(void 0,void 0,void 0,(function*(){const t=yield i("https://rickandmortyapi.com/api/episode");var n;o((n=JSON.stringify(t),{type:e.ADD_EPISODES,payload:n}));const c=yield(e=>s(void 0,void 0,void 0,(function*(){const t=r(e);return a(t)})))(t);setTimeout((()=>{(t=>{s(void 0,void 0,void 0,(function*(){var n;o((n=JSON.stringify(t),{type:e.ADD_CHARACTER,payload:n}))}))})(c)}),500)}));class d extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),t.push(this)}connectedCallback(){this.render()}render(){var e,t,o,i,s,r;return o=this,i=void 0,r=function*(){if(this.shadowRoot){this.shadowRoot.innerHTML="";const o=this.ownerDocument.createElement("link");o.setAttribute("rel","stylesheet"),o.setAttribute("href","/src/index.css"),null===(e=this.shadowRoot)||void 0===e||e.appendChild(o),338!==(null===(t=n.characters)||void 0===t?void 0:t.length)?this.ownerDocument.createElement("h1").textContent="LOADING...":n.episodes.forEach((e=>{var t;const n=this.ownerDocument.createElement("episode-card");n.setAttribute("name",`${e.name}`),n.setAttribute("air_date",`${e.air_date}`),n.setAttribute("episode",`${e.episode}`),n.setAttribute("characters",`${JSON.stringify(e.characters)}`),null===(t=this.shadowRoot)||void 0===t||t.appendChild(n)}))}},new((s=void 0)||(s=Promise))((function(e,t){function n(e){try{c(r.next(e))}catch(e){t(e)}}function a(e){try{c(r.throw(e))}catch(e){t(e)}}function c(t){var o;t.done?e(t.value):(o=t.value,o instanceof s?o:new s((function(e){e(o)}))).then(n,a)}c((r=r.apply(o,i||[])).next())}))}}customElements.define("app-container",d)})();